"use strict";Vue.http.options.emulateJSON=!0;var vm1=new Vue({el:"#mCalculation",components:{},data:function(){return{beginShow:!1,subjectShow:!1,stepData:[1,2,3,4,5,6,7,8,9,10,11],step:1,errorShow:!1,errorText:"您还未完成选填",errorClean:null,timer:2,isInput:!1,isClick:!1,isBack:!1,calcData:{step1:{isShow:!1,text:"请选择",seleteIndex:[],yearData:[{text:"1959",value:"1959"},{text:"1960",value:"1960"},{text:"1961",value:"1961"},{text:"1962",value:"1962"},{text:"1963",value:"1963"},{text:"1964",value:"1964"},{text:"1965",value:"1965"},{text:"1966",value:"1966"},{text:"1967",value:"1967"},{text:"1968",value:"1968"},{text:"1969",value:"1969"},{text:"1970",value:"1970"},{text:"1971",value:"1971"},{text:"1972",value:"1972"},{text:"1973",value:"1973"},{text:"1974",value:"1974"},{text:"1975",value:"1975"},{text:"1976",value:"1976"},{text:"1977",value:"1977"},{text:"1978",value:"1978"},{text:"1979",value:"1979"},{text:"1980",value:"1980"},{text:"1981",value:"1981"},{text:"1982",value:"1982"},{text:"1983",value:"1983"},{text:"1984",value:"1984"},{text:"1985",value:"1985"},{text:"1986",value:"1986"},{text:"1987",value:"1987"},{text:"1988",value:"1988"},{text:"1989",value:"1989"},{text:"1990",value:"1990"},{text:"1991",value:"1991"},{text:"1992",value:"1992"},{text:"1993",value:"1993"},{text:"1994",value:"1994"},{text:"1995",value:"1995"},{text:"1996",value:"1996"},{text:"1997",value:"1997"},{text:"1998",value:"1998"},{text:"1999",value:"1999"},{text:"2000",value:"2000"},{text:"2001",value:"2001"}],monthData:[{text:"1",value:"1"},{text:"2",value:"2"},{text:"3",value:"3"},{text:"4",value:"4"},{text:"5",value:"5"},{text:"6",value:"6"},{text:"7",value:"7"},{text:"8",value:"8"},{text:"9",value:"9"},{text:"10",value:"10"},{text:"11",value:"11"},{text:"12",value:"12"}]},step2:{isShow:!1,data:[{key:"below_high_school",value:"高中（中职）及以下"},{key:"college",value:"大专（高职）学历"},{key:"bachelor",value:"大学本科学历"},{key:"bachelor_degree",value:"本科学历+学士学位"},{key:"master",value:"硕士学历学位双证"},{key:"doctor",value:"博士学历学位双证"}],record:[{value:1,text:"全日制"},{value:2,text:"非全日制"}],seleteTit:"请选择",seleteRecord:0,seleteIndex:0},step3:{isShow:!1,data:[{key:"level_5",value:"国家职业资格五级"},{key:"level_4",value:"国家职业资格四级"},{key:"level_3",value:"国家职业资格三级"},{key:"level_2",value:"国家职业资格二级或中级职称"},{key:"level_1",value:"国家职业资格一级或高级职称"},{key:"level_0",value:"以上皆无"}],isSelete:[{value:1,text:"是"},{value:0,text:"否"}],level:"",seleteIndex:0,seleteTit:"请选择",level_4_5_needed:void 0},step4:{isShow:!1,seleteRadio:void 0,year:""},step5:{isShow:!1,data:[{key:"level_1",value:"每月缴纳金额在449.3~609元之间"},{key:"level_2",value:"4年内累计36个月每月缴纳金额609~756元"},{key:"level_3",value:"4年内累计36个月每月缴纳金额756~1575元"},{key:"level_4",value:"4年内累计36个月每月缴纳金额1575~2257.5元"},{key:"level_5",value:"3年内累计24个月每月缴纳金额2257.5元"},{key:"level_0",value:"未缴纳社保"}]},step6:{isShow:!1,data:[{key:"level_1",value:"获得本市部、委、办、局等级专项型奖励"},{key:"level_2",value:"获得本市部、委、办、局等级综合型奖励"},{key:"level_3",value:"获得省部级及以上政府表彰奖励"},{key:"level_0",value:"以上皆无"}]},step7:{isShow:!1,seleteRadio:void 0,share_ratio:"",tax_amount:"",employees_num:""},step8:{isShow:!1,data:[{key:"interface1",value:"满足入驻经备案的科技企业孵化器中满6个月且入驻前持股比例不低于5%"},{key:"interface2",value:"在经备案的本市技术转移服务机构中连续从事技术转移和科技成果转化满6个月"},{key:"interface0",value:"以上皆无"}],seleteRadio:""},step9:{isShow:!1,data:[{key:"needed1",value:"全日制应届高校大学生",checked:!1,disabled:!1},{key:"needed2",value:"全日制大专毕业且所学专业为紧缺急需专业",checked:!1,disabled:!1},{key:"needed0",value:"以上皆无",checked:!1,disabled:!1}]},step10:{isShow:!1,seleteRadio:void 0,port_work:"",sanitation_work:""},step11:{isShow:!1,data:[{key:"violation2",value:"近5年内有行政拘留记录",value1:"年",text:"",isShow:!0,checked:!1},{key:"violation1",value:"最近3年内申请积分时提供虚假材料",value1:"次",text:"",isShow:!0,checked:!1},{key:"violation0",value:"以上皆无",value1:"",isShow:!1,checked:!1}]}},seleteCalc:{sub1:{which:"p1",answer:"",integral:"",url:"",token:""},sub2:{which:"p2",answer:"",integral:"",token:""},sub3:{which:"p3",answer:"",integral:"",token:""},sub4:{which:"p4",answer:"",integral:"",token:""},sub5:{which:"p5",answer:"",integral:"",token:""},sub6:{which:"p6",answer:"",integral:"",token:""},sub7:{which:"p7",answer:"",integral:"",token:""},sub8:{which:"p8",answer:"",integral:"",token:""},sub9:{which:"p9",answer:"",integral:"",token:""},sub10:{which:"p10",answer:"",integral:"",token:""},sub11:{which:"p11",answer:"",integral:"",token:""},sub12:{which:"p12",tel:"",score:0,name:"未知",img_code:"",integral:"",token:"",source:2==window.location.href.split("?").length?window.location.href.split("?")[1]:null==window.localStorage.getItem("source")||"null"==window.localStorage.getItem("source")?"":window.localStorage.getItem("source"),sourceChange:{},url:window.location.href,old_url:null==localStorage.getItem("enterUrl")?location.href:localStorage.getItem("enterUrl")}},img_yzm:null,successInfo:{maskShow:!1,successShow1:!1,successShow2:!1,name:"",nameError:"",nameErrorShow:!1,phone:"",phoneError:"",phoneErrorShow:!1,time:5,msgtipTime:null,imgShow:!1},skip:"直接跳下一步",point:new Point.default,openId:"",calcHeight:0,isHeight:!1,isBegin:!1,boxHeight:0,kongHeight:0,headH:0,kongH:0,navH:0,noLayout:location.pathname.indexOf("wxapp")>-1,isMini:!1,baseUrl:"https://www.zjtrain.cn"}},mounted:function(){this.point.reward="level_0",this.calcData.step7.seleteRadio=0,this.calcData.step8.seleteRadio="interface0",this.calcData.step9.data[2].checked=!0,this.calcData.step10.seleteRadio=0,this.calcData.step11.data[2].checked=!0,this.openId=this.getQueryString("openid"),this.headH=document.getElementById("mHead")?document.getElementById("mHead").offsetHeight:0,this.kongH=document.getElementById("ft")?document.getElementById("ft").offsetHeight:0,this.navH=this.noLayout?0:document.getElementById("nav").offsetHeight,this.calcHeight=this.getWindowHeight()-this.headH-this.kongH-this.navH,this.kongHeight=document.getElementById("kong")?document.getElementById("kong").offsetHeight:0,this.openId?(this.subjectShow=!0,this.calcData.step1.isShow=!0):document.querySelector(".section1").offsetHeight+document.querySelector(".btn").offsetHeight>this.calcHeight?this.isBegin=!0:this.isBegin=!1,$("input").on("blur",function(){window.scroll(0,0)})},watch:{isInput:function(e){e?(document.querySelector("#mFooter").querySelector(".section_2").style.opacity=0,document.querySelector("#mFooter").querySelector(".section_2").zIndex="-1"):(document.querySelector("#mFooter").querySelector(".section_2").style.opacity=1,document.querySelector("#mFooter").querySelector(".section_2").zIndex="1")}},created:function(){},methods:{getWindowHeight:function(){var e=window,t=document,s=t.documentElement,a=t.getElementsByTagName("body")[0];return e.innerHeight||s.clientHeight||a.clientHeight},beginFun:function(){this.beginShow=!this.beginShow,this.subjectShow=!this.subjectShow,this.calcData.step1.isShow=!0,this.calcHeight=this.getWindowHeight()-this.headH-this.kongH-this.navH,this.boxHeight=document.getElementById("step1").offsetHeight+this.kongHeight+document.querySelector(".btn").offsetHeight,this.isBegin=!1,this.boxHeight>this.calcHeight?this.isHeight=!0:this.isHeight=!1},getQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),s=new RegExp("(^|/)"+e+"/([^/]*)(/|$)","i"),a=window.location.search.substr(1).match(t),i=window.location.pathname.substr(1).match(s);return null!=a?unescape(a[2]):null!=i?unescape(i[2]):null},pickerFun:function(e,t,s,a,i){var c=document.getElementById(t).querySelector(".picker-text"),l=new Picker({data:[e],selectedIndex:s&&a?[s[a]]:[0]});l.on("picker.select",function(t,a){c.innerText=e[a].text,s&&i&&(s[i]=e[a].text)}),l.on("picker.change",function(e,t){}),l.on("picker.valuechange",function(e,t){s&&a&&(s[a]=t[0])}),l.show()},agePicker:function(){this.radioChange();var e=this,t=document.getElementById("age").querySelector(".picker-text"),s=new Picker({data:[e.calcData.step1.yearData,e.calcData.step1.monthData],selectedIndex:void 0==e.calcData.step1.selectedIndex?[26,0]:e.calcData.step1.selectedIndex});s.on("picker.select",function(s,a){t.innerText=e.calcData.step1.yearData[a[0]].text+" 年 "+e.calcData.step1.monthData[a[1]].text+" 月"}),s.on("picker.change",function(e,t){}),s.on("picker.valuechange",function(t,s){e.calcData.step1.text=t,e.calcData.step1.selectedIndex=s}),s.show()},recordPicker:function(){this.radioChange(),this.pickerFun(this.calcData.step2.record,"record",this.calcData.step2,"seleteIndex","seleteTit")},professionalPicker:function(){this.radioChange(),this.pickerFun(this.calcData.step3.isSelete,"professional",this.calcData.step3,"seleteIndex","seleteTit")},radioValue:function(e,t){var s="";return e.forEach(function(e){e.key==t&&(s=e.value)}),s},answerFun:function(e,t,s,a,i){var c="";c=this.openId?this.baseUrl+"/site/wxcounter":this.baseUrl+"/site/counter",this.$http.post(c,{data:e}).then(function(e){},function(e){console.log(e)}),this.isHeight=!1,this.calcHeight=this.getWindowHeight()-this.headH-this.kongH-this.navH,t.isShow=!1,s.isShow=!0,this.boxHeight=document.getElementById(a).offsetHeight+this.kongHeight+document.querySelector(".btn").offsetHeight,this.boxHeight>this.calcHeight?this.isHeight=!0:this.isHeight=!1,this.step=i?"不跳下一步"==i?6:this.step+2:this.step+1},upFun:function(e,t,s,a){e.isShow=!0,t.isShow=!1,this.step=a?this.step-2:this.step-1,this.stepHeight=document.getElementById(s).offsetHeight},radioC:function(e){var t=this;this.radioChange(),setTimeout(function(){t.boxHeight=document.getElementById(e).offsetHeight+t.kongHeight+document.querySelector(".btn").offsetHeight,t.boxHeight>t.calcHeight?t.isHeight=!0:t.isHeight=!1},20)},randomNum:function(){for(var e="",t=0;t<3;t++){e+=Math.floor(10*Math.random())}return e="jfm"+(new Date).getTime()+e},subject1:function(){var e=new Date,t=e.getFullYear(),s=e.getMonth()+1,a=0;this.calcData.step1.isShow&&("请选择"==this.calcData.step1.text?this.showmsg():(this.openId?this.seleteCalc.sub1.token=this.openId:this.isBack?this.seleteCalc.sub1.integral=this.seleteCalc.sub1.integral:this.seleteCalc.sub1.integral=this.randomNum(),a=this.calcData.step1.text[1]>s?t-this.calcData.step1.text[0]-1:t-this.calcData.step1.text[0],this.point.age=a>=18&&a<=43?18:a,this.seleteCalc.sub1.answer=a,this.seleteCalc.sub1.url=window.location.href,this.answerFun(this.seleteCalc.sub1,this.calcData.step1,this.calcData.step2,"step2")))},up2:function(){this.isBack=!0,this.upFun(this.calcData.step1,this.calcData.step2,"step1")},subject2:function(){this.calcData.step2.isShow&&(this.point.education&&"请选择"!=this.calcData.step2.seleteTit?(this.calcData.step2.seleteRecord=this.calcData.step2.record[this.calcData.step2.seleteIndex].value,"bachelor"!=this.point.education&&"bachelor_degree"!=this.point.education&&"master"!=this.point.education&&"doctor"!=this.point.education||1==this.calcData.step2.seleteRecord&&(this.calcData.step9.data[1].disabled=!0),"below_high_school"!=this.point.education&&2!=this.calcData.step2.seleteRecord||(this.calcData.step9.data[0].disabled=!0,this.calcData.step9.data[1].disabled=!0),this.seleteCalc.sub2.answer=this.calcData.step2.seleteTit+"-"+this.radioValue(this.calcData.step2.data,this.point.education),this.openId?this.seleteCalc.sub2.token=this.openId:this.seleteCalc.sub2.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub2,this.calcData.step2,this.calcData.step3,"step3")):this.showmsg())},up3:function(){this.upFun(this.calcData.step2,this.calcData.step3,"step2")},subject3:function(){if(this.calcData.step3.isShow)if(""==this.calcData.step3.level)this.showmsg();else{if(this.calcData.step3.level_4_5_needed=this.calcData.step3.isSelete[this.calcData.step3.seleteIndex].value,"level_2"==this.calcData.step3.level||"level_1"==this.calcData.step3.level){if("请选择"==this.calcData.step3.seleteTit)return void this.showmsg();this.point.professional_skills={level:this.calcData.step3.level,level_4_5_needed:this.calcData.step3.level_4_5_needed};var e=0==this.calcData.step3.level_4_5_needed?"否":"是";this.seleteCalc.sub3.answer=this.radioValue(this.calcData.step3.data,this.point.professional_skills.level)+"-"+e}else this.point.professional_skills={level:this.calcData.step3.level},this.seleteCalc.sub3.answer=this.radioValue(this.calcData.step3.data,this.point.professional_skills.level);this.openId?this.seleteCalc.sub3.token=this.openId:this.seleteCalc.sub3.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub3,this.calcData.step3,this.calcData.step4,"step4")}},up4:function(){this.upFun(this.calcData.step3,this.calcData.step4,"step3")},subject4:function(){if(this.calcData.step4.isShow)if(void 0==this.calcData.step4.seleteRadio)this.showmsg();else if(this.point.social_security=0==this.calcData.step4.seleteRadio?0:this.calcData.step4.year,1==this.calcData.step4.seleteRadio){if(""==this.point.social_security)return this.errorText="填入值不能为空",void this.showmsg();if(isNaN(this.point.social_security))return this.errorText="填入值必须为数字",void this.showmsg();this.seleteCalc.sub4.answer=this.point.social_security,this.openId?this.seleteCalc.sub4.token=this.openId:this.seleteCalc.sub4.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub4,this.calcData.step4,this.calcData.step5,"step5")}else this.seleteCalc.sub4.answer="否",this.openId?this.seleteCalc.sub4.token=this.openId:this.seleteCalc.sub4.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub4,this.calcData.step4,this.calcData.step6,"step6",this.skip),""==!this.seleteCalc.sub5.answer&&(this.point.hign_social_security=void 0,this.seleteCalc.sub5.answer="(未设置)",this.answerFun(this.seleteCalc.sub5,this.calcData.step4,this.calcData.step6,"step6","不跳下一步"))},up5:function(){this.upFun(this.calcData.step4,this.calcData.step5,"step4")},subject5:function(){this.calcData.step5.isShow&&(this.point.hign_social_security?(this.seleteCalc.sub5.answer=this.radioValue(this.calcData.step5.data,this.point.hign_social_security),this.openId?this.seleteCalc.sub5.token=this.openId:this.seleteCalc.sub5.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub5,this.calcData.step5,this.calcData.step6,"step6")):this.showmsg())},up6:function(){1==this.calcData.step4.seleteRadio?this.upFun(this.calcData.step5,this.calcData.step6,"step5"):this.upFun(this.calcData.step4,this.calcData.step6,"step4",this.skip)},subject6:function(){this.calcData.step6.isShow&&(this.point.reward?(this.seleteCalc.sub6.answer=this.radioValue(this.calcData.step6.data,this.point.reward),this.openId?this.seleteCalc.sub6.token=this.openId:this.seleteCalc.sub6.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub6,this.calcData.step6,this.calcData.step7,"step7")):this.showmsg())},up7:function(){this.upFun(this.calcData.step6,this.calcData.step7,"step6")},subject7:function(){if(this.calcData.step7.isShow)if(void 0==this.calcData.step7.seleteRadio)this.showmsg();else{if(0==this.calcData.step7.seleteRadio)this.point.business={type:this.calcData.step7.seleteRadio},this.seleteCalc.sub7.answer="否";else{if(""==this.calcData.step7.share_ratio||""==this.calcData.step7.tax_amount||""==this.calcData.step7.employees_num)return this.errorText="填入值不能为空",void this.showmsg();if(isNaN(this.calcData.step7.share_ratio)||isNaN(this.calcData.step7.tax_amount)||isNaN(this.calcData.step7.employees_num))return this.errorText="填入值必须为数字",void this.showmsg();if(this.calcData.step7.share_ratio>100)return this.errorText="持股值不能大于100",void this.showmsg();if(this.calcData.step7.employees_num%1!=0)return this.errorText="户籍员工人数为整数",void this.showmsg();this.point.business={type:this.calcData.step7.seleteRadio,share_ratio:this.calcData.step7.share_ratio,tax_amount:this.calcData.step7.tax_amount,employees_num:this.calcData.step7.employees_num},this.seleteCalc.sub7.answer="在企业内持股"+this.calcData.step7.share_ratio+"%，最近3年内平均每年纳税"+this.calcData.step7.tax_amount+"万元，每年雇上海户籍员工"+this.calcData.step7.employees_num+"人。"}this.openId?this.seleteCalc.sub7.token=this.openId:this.seleteCalc.sub7.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub7,this.calcData.step7,this.calcData.step8,"step8")}},up8:function(){this.upFun(this.calcData.step7,this.calcData.step8,"step7")},subject8:function(){this.calcData.step8.isShow&&(""==this.calcData.step8.seleteRadio?this.showmsg():(this.point.innovative_entrepreneurial_talent={innovation:"interface1"==this.calcData.step8.seleteRadio?1:0,entrepreneurship:"interface2"==this.calcData.step8.seleteRadio?1:0},this.seleteCalc.sub8.answer=this.radioValue(this.calcData.step8.data,this.calcData.step8.seleteRadio),this.calcData.step9.data[0].disabled&&this.calcData.step9.data[1].disabled?(this.openId?this.seleteCalc.sub8.token=this.openId:this.seleteCalc.sub8.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub8,this.calcData.step8,this.calcData.step10,"step10",this.skip)):(this.openId?this.seleteCalc.sub8.token=this.openId:this.seleteCalc.sub8.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub8,this.calcData.step8,this.calcData.step9,"step9"))))},neededFun:function(e){this.radioChange(),e.checked?e.checked=!1:e.checked=!0,"needed0"==e.key?this.calcData.step9.data.forEach(function(t){e.key!=t.key&&(t.checked=!1,t.text="")}):this.calcData.step9.data[2].checked=!1},up9:function(){this.upFun(this.calcData.step8,this.calcData.step9,"step8")},subject9:function(){var e=this,t=[];this.calcData.step9.isShow&&(this.calcData.step9.data.forEach(function(s){s.checked&&(t.push(s),"needed0"==s.key?e.seleteCalc.sub9.answer=s.value:e.seleteCalc.sub9.answer+=s.value+"、")}),t.length?(this.point.needed_professional={needed_professional:this.calcData.step9.data[0].checked?1:0,graduation:this.calcData.step9.data[1].checked?1:0},this.openId?this.seleteCalc.sub9.token=this.openId:this.seleteCalc.sub9.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub9,this.calcData.step9,this.calcData.step10,"step10")):this.showmsg())},up10:function(){this.calcData.step9.data[0].disabled&&this.calcData.step9.data[1].disabled?this.upFun(this.calcData.step8,this.calcData.step10,"step8",this.skip):this.upFun(this.calcData.step9,this.calcData.step10,"step9")},subject10:function(){if(this.calcData.step10.isShow)if(void 0==this.calcData.step10.seleteRadio)this.showmsg();else{if(1==this.calcData.step10.seleteRadio){if(""==this.calcData.step10.port_work&&""==this.calcData.step10.sanitation_work)return this.errorText="填入值不能为空",void this.showmsg();if(isNaN(this.calcData.step10.port_work)||isNaN(this.calcData.step10.sanitation_work))return this.errorText="填入值必须为数字",void this.showmsg();this.seleteCalc.sub10.answer="在临港地区工作并居住证，满"+this.calcData.step10.port_work+"年，在上海市环卫领域服务，满"+this.calcData.step10.sanitation_work+"年。"}else this.seleteCalc.sub10.answer="否";this.point.hard_word={port_work:0==this.calcData.step10.seleteRadio?0:this.calcData.step10.port_work,sanitation_work:0==this.calcData.step10.seleteRadio?0:this.calcData.step10.sanitation_work},this.openId?this.seleteCalc.sub10.token=this.openId:this.seleteCalc.sub10.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub10,this.calcData.step10,this.calcData.step11,"step11")}},violationFun:function(e){this.radioChange(),e.checked?(e.checked=!1,e.text=""):e.checked=!0,"violation0"==e.key?this.calcData.step11.data.forEach(function(t){e.key!=t.key&&(t.checked=!1,t.text="")}):this.calcData.step11.data[2].checked=!1},up11:function(){this.upFun(this.calcData.step10,this.calcData.step11,"step10")},subject11:function(){var e=this,t=[],s=!1;if(this.calcData.step11.isShow){if(this.calcData.step11.data.forEach(function(a){if(a.checked){if(t.push(a),a.isShow){if(""==a.text)return e.errorText="填入值不能为空",e.showmsg(),void(s=!0);if(isNaN(a.text))return e.errorText="填入值必须为数字",e.showmsg(),void(s=!0);s=!1,e.seleteCalc.sub11.answer+=a.value+a.text+a.value1+"、"}else e.seleteCalc.sub11.answer=a.value;e.openId?e.seleteCalc.sub11.token=e.openId:e.seleteCalc.sub11.integral=e.seleteCalc.sub1.integral}}),!t.length)return void this.showmsg();if(this.point.violation_of_law={false_material:this.calcData.step11.data[1].checked?this.calcData.step11.data[1].text:0,detention:this.calcData.step11.data[0].checked?this.calcData.step11.data[0].text:0},!s)if(this.openId){if(this.isMini)return;this.isMini=!0,this.$http.post(this.baseUrl+"/site/wxcounter",{data:this.seleteCalc.sub11}).then(function(e){},function(e){this.isMini=!1});var a=this.point.total_point;wx.miniProgram.navigateTo({url:"/pages/index/phone?score="+a})}else this.$http.post(this.baseUrl+"/site/counter",{data:this.seleteCalc.sub11}).then(function(e){1==e.data.status&&(this.successInfo.imgShow=!1,this.successInfo.maskShow=!0,this.successInfo.successShow1=!0)},function(e){console.log(e)})}},showmsg:function(){var e=this;this.errorShow=!0,e.errorClean=setInterval(function(){e.timer=e.timer-1,0==e.timer&&e.radioChange()},1e3)},radioChange:function(){clearInterval(this.errorClean),this.errorShow=!1,this.timer=2},validatePhone:function(e){var t=/^(\+?0?86\-?)?1[3456789]\d{9}$/;return""==this.successInfo.phone?(this.successInfo.phoneError="*联系方式不能为空",this.successInfo.phoneErrorShow=!0,!1):!!t.test(this.successInfo.phone)||(this.successInfo.phoneError="*请填写正确格式",this.successInfo.phoneErrorShow=!0,!1)},phoneBlur:function(){this.validatePhone(this.successInfo.phone)},submit1:function(){if(""==this.successInfo.name)this.successInfo.nameError="*称呼未填写",this.successInfo.nameErrorShow=!0;else if(this.validatePhone(this.successInfo.phone)){if(this.isClick)return;this.isClick=!0,this.seleteCalc.sub12.name=""==this.successInfo.name?"未知":this.successInfo.name,this.seleteCalc.sub12.tel=this.successInfo.phone,this.seleteCalc.sub12.score=this.point.total_point,this.seleteCalc.sub12.integral=this.seleteCalc.sub1.integral,this.seleteCalc.sub12=commonForm.prepareData(this.seleteCalc.sub12),this.$http.post(this.baseUrl+"/site/counter",{data:this.seleteCalc.sub12}).then(function(e){1==e.data.img_code?this.$http.post(this.baseUrl+"/site/img-code",{}).then(function(e){this.img_yzm=e.data,this.successInfo.imgShow=!0,this.isClick=!1}):(this.successInfo.successShow1=!1,this.successInfo.successShow2=!0,this.submit2(),this.successInfo.name="",this.successInfo.phone="",this.seleteCalc.sub12.img_code="",this.successInfo.nameErrorShow=!1,this.successInfo.phoneErrorShow=!1,this.isClick=!1)},function(e){console.log(e)})}},yzmFun:function(){this.$http.post(this.baseUrl+"/site/img-code",{}).then(function(e){this.img_yzm=e.data})},submit2:function(){var e=this;this.successInfo.msgtipTime=setInterval(function(){e.successInfo.time=e.successInfo.time-1,0==e.successInfo.time&&window.location.reload()},1e3)},endSubmit:function(){window.location.reload()},successClose:function(){window.location.reload()}}});