Vue.http.options.emulateJSON=!0;var vm1=new Vue({el:"#calculation",components:{},data:function(){return{beginShow:!1,renShow:!1,subjectShow:!1,stepData:[1,2,3,4,5,6,7,8,9,10,11],step:1,isStep:!1,errorShow:!1,errorClean:null,errorText:"您还未完成选填",timer:2,isClick:!1,isBack:!1,calcData:{step1:{isShow:!1,yearText:"",yearDrop:!1,yearData:["1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001"],monthText:"",monthDrop:!1,monthData:["1","2","3","4","5","6","7","8","9","10","11","12"]},step2:{isShow:!1,data:[{key:"below_high_school",value:"高中（中职）及以下"},{key:"college",value:"大专（高职）学历"},{key:"bachelor",value:"大学本科学历"},{key:"bachelor_degree",value:"本科学历+学士学位"},{key:"master",value:"硕士学历学位双证"},{key:"doctor",value:"博士学历学位双证"}],record:[{key:1,value:"全日制"},{key:2,value:"非全日制"}],seleteTit:"请选择",seleteRecord:0,drop:!1},step3:{isShow:!1,data:[{key:"level_5",value:"国家职业资格五级"},{key:"level_4",value:"国家职业资格四级"},{key:"level_3",value:"国家职业资格三级"},{key:"level_2",value:"国家职业资格二级或中级职称"},{key:"level_1",value:"国家职业资格一级或高级职称"},{key:"level_0",value:"以上皆无"}],level:"",level_4_5_needed:void 0},step4:{isShow:!1,seleteRadio:void 0,year:""},step5:{isShow:!1,data:[{key:"level_1",value:"每月缴纳金额在517.3~689.6元之间"},{key:"level_2",value:"4年内累计36个月每月缴纳金额在689.7~862.1元之间"},{key:"level_3",value:"4年内累计36个月每月缴纳金额在862.2~1724.2元之间"},{key:"level_4",value:"4年内累计36个月每月缴纳金额在1724.3~2586.4元之间"},{key:"level_5",value:"3年内累计24个月每月缴纳金额为2586.5元"},{key:"level_0",value:"未缴纳社保"}]},step6:{isShow:!1,data:[{key:"level_1",value:"获得本市部、委、办、局等级专项型奖励"},{key:"level_2",value:"获得本市部、委、办、局等级综合型奖励"},{key:"level_3",value:"获得省部级及以上政府表彰奖励"},{key:"level_0",value:"以上皆无"}]},step7:{isShow:!1,seleteRadio:void 0,share_ratio:"",tax_amount:"",employees_num:""},step8:{isShow:!1,data:[{key:"interface1",value:"满足入驻经备案的科技企业孵化器中满6个月且入驻前持股比例不低于5%"},{key:"interface2",value:"在经备案的本市技术转移服务机构中连续从事技术转移和科技成果转化满6个月"},{key:"interface0",value:"以上皆无"}],seleteRadio:""},step9:{isShow:!1,data:[{key:"needed1",value:"全日制应届高校大学生",checked:!1,disabled:!1},{key:"needed2",value:"全日制大专毕业且所学专业为紧缺急需专业",checked:!1,disabled:!1},{key:"needed0",value:"以上皆无",checked:!0,disabled:!1}]},step10:{isShow:!1,seleteRadio:void 0,port_work:"",sanitation_work:""},step11:{isShow:!1,data:[{key:"violation1",value:"最近3年内申请积分时提供虚假材料",value1:"次",text:"",isShow:!0,checked:!1},{key:"violation2",value:"近5年内有行政拘留记录",value1:"年",text:"",isShow:!0,checked:!1},{key:"violation0",value:"以上皆无",value1:"",isShow:!1,checked:!0}]}},seleteCalc:{sub1:{which:"p1",answer:"",integral:"",url:window.location.href},sub2:{which:"p2",answer:"",integral:""},sub3:{which:"p3",answer:"",integral:""},sub4:{which:"p4",answer:"",integral:""},sub5:{which:"p5",answer:"",integral:""},sub6:{which:"p6",answer:"",integral:""},sub7:{which:"p7",answer:"",integral:""},sub8:{which:"p8",answer:"",integral:""},sub9:{which:"p9",answer:"",integral:""},sub10:{which:"p10",answer:"",integral:""},sub11:{which:"p11",answer:"",integral:""},sub12:{which:"p12",tel:"",score:0,name:"",img_code:"",integral:"",source:2==window.location.href.split("?").length?window.location.href.split("?")[1]:null==window.localStorage.getItem("source")||"null"==window.localStorage.getItem("source")?"":window.localStorage.getItem("source"),sourceChange:{},url:window.location.href,old_url:null==localStorage.getItem("enterUrl")?location.href:localStorage.getItem("enterUrl")}},img_yzm:null,successInfo:{maskShow:!1,successShow1:!1,successShow2:!1,name:"",phone:"",nameError:"",nameErrorShow:!1,phoneError:"",phoneErrorShow:!1,time:5,msgtipTime:null,imgShow:!1},skip:"直接跳下一步",point:new Point.default,stepHeight:0}},mounted:function(){this.point.reward="level_0",this.calcData.step7.seleteRadio=0,this.calcData.step8.seleteRadio="interface0",this.calcData.step10.seleteRadio=0},watch:{},created:function(){},methods:{beginBtn:function(){this.beginShow=!this.beginShow,this.subjectShow=!this.subjectShow,this.isStep=!this.isStep,this.calcData.step1.isShow=!0,this.stepHeight=document.getElementById("calc-step1").offsetHeight},renBtn:function(){this.renShow=!this.renShow},yearFun:function(){this.calcData.step1.yearDrop=!this.calcData.step1.yearDrop,this.calcData.step1.monthDrop=!1,this.errorShow=!1,this.timer=2,clearInterval(this.errorClean),""==this.calcData.step1.yearText&&(document.getElementById("yearScroll").scrollTop=960)},yearSelete:function(value){this.calcData.step1.yearText=value,this.calcData.step1.yearDrop=!1},monthSelete:function(value){this.calcData.step1.monthText=value,this.calcData.step1.monthDrop=!1},recordSelete:function(key,value){this.calcData.step2.seleteRecord=key,this.calcData.step2.seleteTit=value,this.calcData.step2.drop=!1},radioValue:function(data,selete){var answer="";return data.forEach((function(item){item.key==selete&&(answer=item.value)})),answer},answerFun:function(data,obj1,obj2,id,next){obj1.isShow=!1,obj2.isShow=!0,this.step=next&&next?"不跳下一步"==next?6:this.step+2:this.step+1,this.stepHeight=document.getElementById(id).offsetHeight,this.$http.post("/counter",{data:data,_token:document.getElementsByTagName("meta")["csrf-token"].getAttribute("content")}).then((function(res){}),(function(err){console.log(err)}))},upFun:function(obj1,obj2,id,next){obj1.isShow=!0,obj2.isShow=!1,this.step=next?this.step-2:this.step-1,this.stepHeight=document.getElementById(id).offsetHeight},randomNum:function(){for(var rand="",i=0;i<3;i++){var r;rand+=Math.floor(10*Math.random())}return rand="jfpc"+(new Date).getTime()+rand},subject1:function(){var nowData=new Date,year=nowData.getFullYear(),month=nowData.getMonth()+1,age=0,vm=this;this.calcData.step1.isShow&&(this.calcData.step1.yearText&&this.calcData.step1.monthText?(age=this.calcData.step1.monthText>month?year-this.calcData.step1.yearText-1:year-this.calcData.step1.yearText,this.point.age=age>=18&&age<=43?18:age,this.seleteCalc.sub1.answer=age,this.isBack?this.seleteCalc.sub1.integral=this.seleteCalc.sub1.integral:this.seleteCalc.sub1.integral=this.randomNum(),this.answerFun(this.seleteCalc.sub1,this.calcData.step1,this.calcData.step2,"calc-step2")):this.showmsg())},up2:function(){this.isBack=!0,this.upFun(this.calcData.step1,this.calcData.step2,"calc-step1")},subject2:function(){this.calcData.step2.isShow&&(this.point.education&&"请选择"!=this.calcData.step2.seleteTit?("bachelor"!=this.point.education&&"bachelor_degree"!=this.point.education&&"master"!=this.point.education&&"doctor"!=this.point.education||1==this.calcData.step2.seleteRecord&&(this.calcData.step9.data[1].disabled=!0),"below_high_school"!=this.point.education&&2!=this.calcData.step2.seleteRecord||(this.calcData.step9.data[0].disabled=!0,this.calcData.step9.data[1].disabled=!0),this.seleteCalc.sub2.answer=this.calcData.step2.seleteTit+"-"+this.radioValue(this.calcData.step2.data,this.point.education),this.seleteCalc.sub2.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub2,this.calcData.step2,this.calcData.step3,"calc-step3")):this.showmsg())},up3:function(){this.upFun(this.calcData.step2,this.calcData.step3,"calc-step2")},subject3:function(){if(this.calcData.step3.isShow)if(""==this.calcData.step3.level)this.showmsg();else{if("level_2"==this.calcData.step3.level||"level_1"==this.calcData.step3.level){if(null==this.calcData.step3.level_4_5_needed)return void this.showmsg();this.point.professional_skills={level:this.calcData.step3.level,level_4_5_needed:this.calcData.step3.level_4_5_needed};var level_4_5_needed_text=0==this.calcData.step3.level_4_5_needed?"否":"是";this.seleteCalc.sub3.answer=this.radioValue(this.calcData.step3.data,this.point.professional_skills.level)+"-"+level_4_5_needed_text}else this.point.professional_skills={level:this.calcData.step3.level},this.seleteCalc.sub3.answer=this.radioValue(this.calcData.step3.data,this.point.professional_skills.level);this.seleteCalc.sub3.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub3,this.calcData.step3,this.calcData.step4,"calc-step4")}},up4:function(){this.upFun(this.calcData.step3,this.calcData.step4,"calc-step3")},subject4:function(){if(this.calcData.step4.isShow)if(null==this.calcData.step4.seleteRadio)this.showmsg();else if(this.point.social_security=0==this.calcData.step4.seleteRadio?0:this.calcData.step4.year,1==this.calcData.step4.seleteRadio){if(""==this.point.social_security)return this.errorText="填入值不能为空",void this.showmsg();if(isNaN(this.point.social_security))return this.errorText="填入值必须为数字",void this.showmsg();this.seleteCalc.sub4.answer=this.point.social_security,this.seleteCalc.sub4.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub4,this.calcData.step4,this.calcData.step5,"calc-step5")}else this.seleteCalc.sub4.answer="否",this.seleteCalc.sub4.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub4,this.calcData.step4,this.calcData.step6,"calc-step6",this.skip),""==!this.seleteCalc.sub5.answer&&(this.point.hign_social_security=void 0,this.seleteCalc.sub5.answer="(未设置)",this.answerFun(this.seleteCalc.sub5,this.calcData.step4,this.calcData.step6,"calc-step6","不跳下一步"))},up5:function(){this.upFun(this.calcData.step4,this.calcData.step5,"calc-step4")},subject5:function(){this.calcData.step5.isShow&&(this.point.hign_social_security?(this.seleteCalc.sub5.answer=this.radioValue(this.calcData.step5.data,this.point.hign_social_security),this.seleteCalc.sub5.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub5,this.calcData.step5,this.calcData.step6,"calc-step6")):this.showmsg())},up6:function(){1==this.calcData.step4.seleteRadio?this.upFun(this.calcData.step5,this.calcData.step6,"calc-step5"):this.upFun(this.calcData.step4,this.calcData.step6,"calc-step4",this.skip)},subject6:function(){this.calcData.step6.isShow&&(this.point.reward?(this.seleteCalc.sub6.answer=this.radioValue(this.calcData.step6.data,this.point.reward),this.seleteCalc.sub6.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub6,this.calcData.step6,this.calcData.step7,"calc-step7")):this.showmsg())},up7:function(){this.upFun(this.calcData.step6,this.calcData.step7,"calc-step6")},subject7:function(){if(this.calcData.step7.isShow)if(null==this.calcData.step7.seleteRadio)this.showmsg();else{if(0==this.calcData.step7.seleteRadio)this.point.business={type:this.calcData.step7.seleteRadio},this.seleteCalc.sub7.answer="否";else{if(""==this.calcData.step7.share_ratio||""==this.calcData.step7.tax_amount||""==this.calcData.step7.employees_num)return this.errorText="填入值不能为空",void this.showmsg();if(isNaN(this.calcData.step7.share_ratio)||isNaN(this.calcData.step7.tax_amount)||isNaN(this.calcData.step7.employees_num))return this.errorText="填入值必须为数字",void this.showmsg();if(this.calcData.step7.share_ratio>100)return this.errorText="持股值不能大于100",void this.showmsg();if(this.calcData.step7.employees_num%1!=0)return this.errorText="户籍员工人数为整数",void this.showmsg();this.point.business={type:this.calcData.step7.seleteRadio,share_ratio:this.calcData.step7.share_ratio,tax_amount:this.calcData.step7.tax_amount,employees_num:this.calcData.step7.employees_num},this.seleteCalc.sub7.answer="在企业内持股"+this.calcData.step7.share_ratio+"%，最近3年内平均每年纳税"+this.calcData.step7.tax_amount+"万元，每年雇上海户籍员工"+this.calcData.step7.employees_num+"人。"}this.seleteCalc.sub7.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub7,this.calcData.step7,this.calcData.step8,"calc-step8")}},up8:function(){this.upFun(this.calcData.step7,this.calcData.step8,"calc-step7")},subject8:function(){this.calcData.step8.isShow&&(""==this.calcData.step8.seleteRadio?this.showmsg():(this.point.innovative_entrepreneurial_talent={innovation:"interface1"==this.calcData.step8.seleteRadio?1:0,entrepreneurship:"interface2"==this.calcData.step8.seleteRadio?1:0},this.seleteCalc.sub8.answer=this.radioValue(this.calcData.step8.data,this.calcData.step8.seleteRadio),this.calcData.step9.data[0].disabled&&this.calcData.step9.data[1].disabled?(this.seleteCalc.sub8.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub8,this.calcData.step8,this.calcData.step10,"calc-step10",this.skip)):(this.seleteCalc.sub8.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub8,this.calcData.step8,this.calcData.step9,"calc-step9"))))},neededFun(item){var _this=this;this.radioChange(),item.checked?item.checked=!1:item.checked=!0,"needed0"==item.key?this.calcData.step9.data.forEach((function(list){item.key!=list.key&&(list.checked=!1,list.text="")})):this.calcData.step9.data[2].checked=!1},up9:function(){this.upFun(this.calcData.step8,this.calcData.step9,"calc-step8")},subject9:function(){var _this=this,selectedList=[];this.calcData.step9.isShow&&(this.calcData.step9.data.forEach((function(item){item.checked&&(selectedList.push(item),"needed0"==item.key?_this.seleteCalc.sub9.answer=item.value:_this.seleteCalc.sub9.answer+=item.value+"、")})),selectedList.length?(this.point.needed_professional={needed_professional:this.calcData.step9.data[0].checked?1:0,graduation:this.calcData.step9.data[1].checked?1:0},this.seleteCalc.sub9.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub9,this.calcData.step9,this.calcData.step10,"calc-step10")):this.showmsg())},up10:function(){this.calcData.step9.data[0].disabled&&this.calcData.step9.data[1].disabled?this.upFun(this.calcData.step8,this.calcData.step10,"calc-step8",this.skip):this.upFun(this.calcData.step9,this.calcData.step10,"calc-step9")},subject10:function(){if(this.calcData.step10.isShow)if(null==this.calcData.step10.seleteRadio)this.showmsg();else{if(1==this.calcData.step10.seleteRadio){if(""==this.calcData.step10.port_work&&""==this.calcData.step10.sanitation_work)return this.errorText="填入值不能为空",void this.showmsg();if(isNaN(this.calcData.step10.port_work)||isNaN(this.calcData.step10.sanitation_work))return this.errorText="填入值必须为数字",void this.showmsg();this.seleteCalc.sub10.answer="在临港地区工作并居住证，满"+this.calcData.step10.port_work+"年，在上海市环卫领域服务，满"+this.calcData.step10.sanitation_work+"年。"}else this.seleteCalc.sub10.answer="否";this.point.hard_word={port_work:0==this.calcData.step10.seleteRadio?0:this.calcData.step10.port_work,sanitation_work:0==this.calcData.step10.seleteRadio?0:this.calcData.step10.sanitation_work},this.seleteCalc.sub10.integral=this.seleteCalc.sub1.integral,this.answerFun(this.seleteCalc.sub10,this.calcData.step10,this.calcData.step11,"calc-step11")}},violationFun:function(item){var _this=this;this.radioChange(),item.checked?(item.checked=!1,item.text=""):item.checked=!0,"violation0"==item.key?this.calcData.step11.data.forEach((function(list){item.key!=list.key&&(list.checked=!1,list.text="")})):this.calcData.step11.data[2].checked=!1},up11:function(){this.upFun(this.calcData.step10,this.calcData.step11,"calc-step10")},subject11:function(){var _this=this,selectedList=[],isInput=!1;this.calcData.step11.isShow&&(_this.seleteCalc.sub11.integral=_this.seleteCalc.sub1.integral,this.calcData.step11.data.forEach((function(item){if(item.checked)if(selectedList.push(item),item.isShow){if(""==item.text)return _this.errorText="填入值不能为空",_this.showmsg(),void(isInput=!0);if(isNaN(item.text))return _this.errorText="填入值必须为数字",_this.showmsg(),void(isInput=!0);isInput=!1,_this.seleteCalc.sub11.answer+=item.value+item.text+item.value1+"、"}else isInput=!1,_this.seleteCalc.sub11.answer=item.value})),selectedList.length?(this.point.violation_of_law={false_material:this.calcData.step11.data[0].checked?this.calcData.step11.data[0].text:0,detention:this.calcData.step11.data[1].checked?this.calcData.step11.data[1].text:0},isInput||this.$http.post("/counter",{data:this.seleteCalc.sub11,_token:document.getElementsByTagName("meta")["csrf-token"].getAttribute("content")}).then((function(res){1==res.data.status&&(this.successInfo.imgShow=!1,this.successInfo.maskShow=!0,this.successInfo.successShow1=!0)}),(function(err){console.log(err)}))):this.showmsg())},showmsg:function(){var _this=this;this.errorShow=!0,this.errorClean=setInterval((function(){_this.timer=_this.timer-1,0==_this.timer&&_this.radioChange()}),1e3)},radioChange:function(){clearInterval(this.errorClean),this.errorShow=!1,this.timer=2},validatePhone:function(phone){var mobile=/^1[3456789]\d{9}$/;return""==this.successInfo.phone?(this.successInfo.phoneError="*联系方式不能为空",this.successInfo.phoneErrorShow=!0,!1):!!mobile.test(this.successInfo.phone)||(this.successInfo.phoneError="*请填写正确格式",this.successInfo.phoneErrorShow=!0,!1)},phoneBlur:function(){this.validatePhone(this.successInfo.phone)},submit1:function(){var vm=this,key="",value="";if(""==this.successInfo.name)this.successInfo.nameError="*称呼未填写",this.successInfo.nameErrorShow=!0;else if(this.validatePhone(this.successInfo.phone)){if(this.isClick)return;this.isClick=!0,this.seleteCalc.sub12.name=""==this.successInfo.name?"未知":this.successInfo.name,this.seleteCalc.sub12.tel=this.successInfo.phone,this.seleteCalc.sub12.score=this.point.total_point,this.seleteCalc.sub12.integral=this.seleteCalc.sub1.integral,this.seleteCalc.sub12=commonForm.prepareData(this.seleteCalc.sub12),this.$http.post("/counter",{data:this.seleteCalc.sub12,_token:document.getElementsByTagName("meta")["csrf-token"].getAttribute("content")}).then((function(res){1==res.data.img_code?this.$http.post("/site/img-code",{}).then((function(data){this.img_yzm=data.data,this.successInfo.imgShow=!0,this.isClick=!1})):(this.submit2(),this.isClick=!1,this.successInfo.nameErrorShow=!1,this.successInfo.phoneErrorShow=!1,this.successInfo.successShow1=!1,this.successInfo.successShow2=!0,this.successInfo.name="",this.successInfo.phone="",this.seleteCalc.sub12.img_code="")}),(function(err){console.log(err)}))}},yzmFun:function(){this.$http.post("/site/img-code",{}).then((function(data){this.img_yzm=data.data}))},submit2:function(){var _this=this;this.successInfo.msgtipTime=setInterval((function(){_this.successInfo.time=_this.successInfo.time-1,1==_this.successInfo.time&&(location.href="/")}),1e3)},successClose:function(){location.href="/"}}});